"use strict";(self.webpackChunksaasready_docs=self.webpackChunksaasready_docs||[]).push([[711],{6986(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"features","title":"Platform Features","description":"Deep dive into SaaSReady features including 2FA, session management, password resets, and brute-force protection.","source":"@site/../docs/features.md","sourceDirName":".","slug":"/features","permalink":"/saasready/docs/features","draft":false,"unlisted":false,"editUrl":"https://github.com/ramprag/saasready/edit/master/docs/../docs/features.md","tags":[],"version":"current","frontMatter":{"title":"Platform Features","description":"Deep dive into SaaSReady features including 2FA, session management, password resets, and brute-force protection.","keywords":["SaaS auth features","2FA TOTP implementation","session management security","brute force protection"]},"sidebar":"tutorialSidebar","previous":{"title":"Production Deployment","permalink":"/saasready/docs/deployment"},"next":{"title":"Framework Integration Examples","permalink":"/saasready/docs/framework-examples"}}');var r=i(4848),t=i(8453);const d={title:"Platform Features",description:"Deep dive into SaaSReady features including 2FA, session management, password resets, and brute-force protection.",keywords:["SaaS auth features","2FA TOTP implementation","session management security","brute force protection"]},l="Feature Documentation",c={},o=[{value:"Email Verification",id:"email-verification",level:2},{value:"How It Works",id:"how-it-works",level:3},{value:"API Endpoints",id:"api-endpoints",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Verification Email Template",id:"verification-email-template",level:3},{value:"Invitation-Based Registration",id:"invitation-based-registration",level:2},{value:"How It Works",id:"how-it-works-1",level:3},{value:"Registration with Invitation Token",id:"registration-with-invitation-token",level:3},{value:"SDK Usage",id:"sdk-usage",level:3},{value:"Key Differences from Normal Registration",id:"key-differences-from-normal-registration",level:3},{value:"API Key Authentication",id:"api-key-authentication",level:2},{value:"Overview",id:"overview",level:3},{value:"Usage",id:"usage",level:3},{value:"Configuration",id:"configuration-1",level:3},{value:"Security Notes",id:"security-notes",level:3},{value:"Refresh Token Rotation",id:"refresh-token-rotation",level:2},{value:"How It Works",id:"how-it-works-2",level:3},{value:"Token Lifetimes",id:"token-lifetimes",level:3},{value:"Security Benefits",id:"security-benefits",level:3},{value:"SDK Usage",id:"sdk-usage-1",level:3},{value:"Session Management",id:"session-management",level:2},{value:"Per-Device Session Tracking",id:"per-device-session-tracking",level:3},{value:"Session Data Tracked",id:"session-data-tracked",level:3},{value:"Maximum Sessions per User",id:"maximum-sessions-per-user",level:3},{value:"API Endpoints",id:"api-endpoints-1",level:3},{value:"Password Reset Flow",id:"password-reset-flow",level:2},{value:"Flow Diagram",id:"flow-diagram",level:3},{value:"Security Features",id:"security-features",level:3},{value:"Brute Force Protection",id:"brute-force-protection",level:2},{value:"Protection Mechanisms",id:"protection-mechanisms",level:3},{value:"Configuration",id:"configuration-2",level:3},{value:"Lockout Behavior",id:"lockout-behavior",level:3},{value:"Two-Factor Authentication (TOTP)",id:"two-factor-authentication-totp",level:2},{value:"Setup Flow",id:"setup-flow",level:3},{value:"Backup Codes",id:"backup-codes",level:3},{value:"Login with 2FA",id:"login-with-2fa",level:3},{value:"Supported Authenticator Apps",id:"supported-authenticator-apps",level:3},{value:"Security Headers",id:"security-headers",level:2},{value:"Audit Logging",id:"audit-logging",level:2},{value:"Events Logged",id:"events-logged",level:3},{value:"Log Retention",id:"log-retention",level:3}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"feature-documentation",children:"Feature Documentation"})}),"\n",(0,r.jsx)(n.p,{children:"This document provides detailed information about SaaSReady's security and authentication features."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"email-verification",children:"Email Verification"}),"\n",(0,r.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On Registration"}),": User registers \u2192 Verification email sent automatically"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Email Contains"}),": Verification link with time-limited token"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On Click"}),": Token validated \u2192 ",(0,r.jsx)(n.code,{children:"is_email_verified"})," set to ",(0,r.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Endpoint"}),(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/auth/verify-email"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Verify email with token"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/auth/resend-verification"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Resend verification email"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# frontend/.env.local\nNEXT_PUBLIC_API_URL=http://localhost:8000\n\n# backend/.env\nEMAIL_SMTP_HOST=smtp.sendgrid.net\nEMAIL_SMTP_PORT=587\nEMAIL_SMTP_USERNAME=apikey\nEMAIL_SMTP_PASSWORD=your-sendgrid-api-key\nEMAIL_FROM=noreply@yourdomain.com\nFRONTEND_BASE_URL=https://yourdomain.com  # For email links\n"})}),"\n",(0,r.jsx)(n.h3,{id:"verification-email-template",children:"Verification Email Template"}),"\n",(0,r.jsx)(n.p,{children:"The email includes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verification link: ",(0,r.jsx)(n.code,{children:"{FRONTEND_BASE_URL}/verify-email?token={token}"})]}),"\n",(0,r.jsx)(n.li,{children:"Token expires in 24 hours"}),"\n",(0,r.jsx)(n.li,{children:"One-time use (invalidated after verification)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"invitation-based-registration",children:"Invitation-Based Registration"}),"\n",(0,r.jsx)(n.p,{children:"When a user is invited to an organization, they can register using a special flow that skips personal organization creation."}),"\n",(0,r.jsx)(n.h3,{id:"how-it-works-1",children:"How It Works"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Admin invites user"}),": ",(0,r.jsx)(n.code,{children:"POST /orgs/{org_id}/invite"})," with email and role"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Email sent"}),": Contains registration link with ",(0,r.jsx)(n.code,{children:"invitation_token"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User registers"}),": ",(0,r.jsx)(n.code,{children:"POST /auth/register"})," with ",(0,r.jsx)(n.code,{children:"invitation_token"})," query param"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Auto-joined"}),": User is directly added to the organization with the assigned role"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"registration-with-invitation-token",children:"Registration with Invitation Token"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Register with invitation token\ncurl -X POST "http://localhost:8000/api/v1/auth/register?invitation_token=abc123" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"email": "invited@example.com", "password": "SecurePass123!", "full_name": "Jane Doe"}\'\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["[!IMPORTANT]\nThe email used during registration ",(0,r.jsx)(n.strong,{children:"must match"})," the invited email address. The system enforces strict email matching for security."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"sdk-usage",children:"SDK Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from saasready import SaaSReady\n\nclient = SaaSReady(base_url="http://localhost:8000")\n\n# Register with invitation token\nresponse = client.auth.register(\n    email="invited@example.com",\n    password="SecurePass123!",\n    full_name="Jane Doe",\n    invitation_token="abc123"  # From invitation email\n)\n\n# User is now logged in and part of the organization\norgs = client.orgs.list()  # Will include the invited org\n'})}),"\n",(0,r.jsx)(n.h3,{id:"key-differences-from-normal-registration",children:"Key Differences from Normal Registration"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspect"}),(0,r.jsx)(n.th,{children:"Normal Registration"}),(0,r.jsx)(n.th,{children:"Invitation Registration"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Personal org created"}),(0,r.jsx)(n.td,{children:"\u2705 Yes"}),(0,r.jsx)(n.td,{children:"\u274c No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Email verification"}),(0,r.jsx)(n.td,{children:"Required"}),(0,r.jsx)(n.td,{children:"Auto-verified"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Organization membership"}),(0,r.jsx)(n.td,{children:"None initially"}),(0,r.jsx)(n.td,{children:"Immediate with role"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"api-key-authentication",children:"API Key Authentication"}),"\n",(0,r.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"API keys enable service-to-service authentication without user credentials. Useful for backend integrations, CI/CD pipelines, and automated scripts."}),"\n",(0,r.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from saasready import SaaSReady\n\n# Initialize with API key (no login required)\nclient = SaaSReady(\n    base_url="https://your-instance.com",\n    api_key="sk_live_your_api_key_here"\n)\n\n# Make authenticated requests directly\norgs = client.orgs.list()\n'})}),"\n",(0,r.jsx)(n.h3,{id:"configuration-1",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# backend/.env\nENABLE_API_KEY_VALIDATION=true  # Enable API key auth\n"})}),"\n",(0,r.jsx)(n.h3,{id:"security-notes",children:"Security Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API keys should be treated like passwords"}),"\n",(0,r.jsx)(n.li,{children:"Store in environment variables, never commit to code"}),"\n",(0,r.jsx)(n.li,{children:"Rotate keys periodically"}),"\n",(0,r.jsx)(n.li,{children:"API keys bypass 2FA (by design, for automation)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"refresh-token-rotation",children:"Refresh Token Rotation"}),"\n",(0,r.jsx)(n.h3,{id:"how-it-works-2",children:"How It Works"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On Login"}),": Both ",(0,r.jsx)(n.code,{children:"access_token"})," and ",(0,r.jsx)(n.code,{children:"refresh_token"})," issued"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Token"}),": Short-lived (default: 60 minutes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Refresh Token"}),": Long-lived (default: 30 days)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On Refresh"}),": New access token issued, refresh token remains valid"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"token-lifetimes",children:"Token Lifetimes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Token Type"}),(0,r.jsx)(n.th,{children:"Default Lifetime"}),(0,r.jsx)(n.th,{children:"Configurable"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Access Token"}),(0,r.jsx)(n.td,{children:"60 minutes"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ACCESS_TOKEN_EXPIRE_MINUTES"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Refresh Token"}),(0,r.jsx)(n.td,{children:"30 days"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"REFRESH_TOKEN_EXPIRE_DAYS"})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"security-benefits",children:"Security Benefits"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Short access tokens"}),": Minimize window if token is compromised"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Long refresh tokens"}),": Better UX, users don't re-login frequently"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token revocation"}),": Both tokens revokable on logout or password change"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"sdk-usage-1",children:"SDK Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Login returns both tokens\nresponse = client.auth.login(email, password)\naccess_token = response.access_token\nrefresh_token = response.refresh_token\n\n# Set both for auto-refresh\nclient.set_token(access_token, refresh_token)\n\n# SDK handles refresh automatically on 401 errors\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"session-management",children:"Session Management"}),"\n",(0,r.jsx)(n.h3,{id:"per-device-session-tracking",children:"Per-Device Session Tracking"}),"\n",(0,r.jsx)(n.p,{children:"SaaSReady tracks active sessions per device, enabling:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-device login"}),": See all active sessions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Remote logout"}),": Revoke specific sessions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Device fingerprinting"}),": Detect suspicious logins"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"session-data-tracked",children:"Session Data Tracked"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"jti"})}),(0,r.jsx)(n.td,{children:"Unique session/token ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"device_info"})}),(0,r.jsx)(n.td,{children:"Browser/app identifier"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ip_address"})}),(0,r.jsx)(n.td,{children:"Login IP address"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user_agent"})}),(0,r.jsx)(n.td,{children:"Full user agent string"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"created_at"})}),(0,r.jsx)(n.td,{children:"Session start time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"last_activity"})}),(0,r.jsx)(n.td,{children:"Last API request time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"is_active"})}),(0,r.jsx)(n.td,{children:"Whether session is valid"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"maximum-sessions-per-user",children:"Maximum Sessions per User"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# backend/.env\nMAX_SESSIONS_PER_USER=5  # Oldest session revoked when exceeded\n"})}),"\n",(0,r.jsx)(n.p,{children:"When limit reached:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"New login succeeds"}),"\n",(0,r.jsx)(n.li,{children:"Oldest active session is revoked"}),"\n",(0,r.jsx)(n.li,{children:"Security alert logged"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"api-endpoints-1",children:"API Endpoints"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Endpoint"}),(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/auth/sessions/current"})}),(0,r.jsx)(n.td,{children:"GET"}),(0,r.jsx)(n.td,{children:"Get current session details"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/auth/security/activity"})}),(0,r.jsx)(n.td,{children:"GET"}),(0,r.jsx)(n.td,{children:"Get login history and alerts"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"password-reset-flow",children:"Password Reset Flow"}),"\n",(0,r.jsx)(n.h3,{id:"flow-diagram",children:"Flow Diagram"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'User clicks "Forgot Password"\n         \u2502\n         \u25bc\nPOST /auth/password-reset/request\n    body: { "email": "user@example.com" }\n         \u2502\n         \u25bc\nSystem sends email with reset link\n    Link: {FRONTEND_BASE_URL}/reset-password?token={token}\n         \u2502\n         \u25bc\nUser clicks link \u2192 Opens reset form\n         \u2502\n         \u25bc\nPOST /auth/password-reset/confirm\n    body: { "token": "...", "new_password": "..." }\n         \u2502\n         \u25bc\nPassword updated, ALL sessions revoked\n'})}),"\n",(0,r.jsx)(n.h3,{id:"security-features",children:"Security Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token expiry"}),": Reset tokens valid for 1 hour"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"One-time use"}),": Token invalidated after use"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Session revocation"}),": All active sessions revoked on password change"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate limited"}),": 3 reset requests per hour per email"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"brute-force-protection",children:"Brute Force Protection"}),"\n",(0,r.jsx)(n.h3,{id:"protection-mechanisms",children:"Protection Mechanisms"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Mechanism"}),(0,r.jsx)(n.th,{children:"Threshold"}),(0,r.jsx)(n.th,{children:"Action"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Failed login count"}),(0,r.jsx)(n.td,{children:"5 attempts"}),(0,r.jsx)(n.td,{children:"Account locked"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Progressive delays"}),(0,r.jsx)(n.td,{children:"Each failure"}),(0,r.jsx)(n.td,{children:"+exponential delay"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IP-based tracking"}),(0,r.jsx)(n.td,{children:"10 attempts"}),(0,r.jsx)(n.td,{children:"IP blocked"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Device ID tracking"}),(0,r.jsx)(n.td,{children:"5 attempts"}),(0,r.jsx)(n.td,{children:"Device blocked"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"configuration-2",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# backend/.env\nMAX_LOGIN_ATTEMPTS=5           # Before lockout\nACCOUNT_LOCKOUT_MINUTES=30     # Lockout duration\nRATE_LIMIT_LOGIN=5             # Per minute\n"})}),"\n",(0,r.jsx)(n.h3,{id:"lockout-behavior",children:"Lockout Behavior"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"After 5 failed attempts \u2192 30-minute lockout"}),"\n",(0,r.jsx)(n.li,{children:"Successful login \u2192 Counter reset"}),"\n",(0,r.jsx)(n.li,{children:"Admin can manually unlock accounts"}),"\n",(0,r.jsx)(n.li,{children:"Security event logged for audit"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"two-factor-authentication-totp",children:"Two-Factor Authentication (TOTP)"}),"\n",(0,r.jsx)(n.h3,{id:"setup-flow",children:"Setup Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"User enables 2FA\n         \u2502\n         \u25bc\nPOST /auth/2fa/setup (authenticated)\n    Returns: { secret, qr_code, provisioning_uri }\n         \u2502\n         \u25bc\nUser scans QR code in authenticator app\n         \u2502\n         \u25bc\nPOST /auth/2fa/verify?verification_code=123456\n    Returns: { backup_codes: [...] }\n         \u2502\n         \u25bc\n2FA is now enabled for this user\n"})}),"\n",(0,r.jsx)(n.h3,{id:"backup-codes",children:"Backup Codes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"5 backup codes generated on 2FA enable"}),"\n",(0,r.jsx)(n.li,{children:"Each code is one-time use"}),"\n",(0,r.jsx)(n.li,{children:"Store securely offline"}),"\n",(0,r.jsx)(n.li,{children:"Can regenerate by disabling/enabling 2FA"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"login-with-2fa",children:"Login with 2FA"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# First attempt returns 2FA required\nresponse = client.auth.login(email, password)\nif response.requires_2fa:\n    # Second attempt with TOTP code\n    response = client.auth.login(email, password, two_factor_code="123456")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"supported-authenticator-apps",children:"Supported Authenticator Apps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Google Authenticator"}),"\n",(0,r.jsx)(n.li,{children:"Authy"}),"\n",(0,r.jsx)(n.li,{children:"1Password"}),"\n",(0,r.jsx)(n.li,{children:"Microsoft Authenticator"}),"\n",(0,r.jsx)(n.li,{children:"Any TOTP-compatible app"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-headers",children:"Security Headers"}),"\n",(0,r.jsx)(n.p,{children:"All responses include security headers:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Header"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"X-Content-Type-Options"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nosniff"})}),(0,r.jsx)(n.td,{children:"Prevent MIME sniffing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"X-Frame-Options"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DENY"})}),(0,r.jsx)(n.td,{children:"Prevent clickjacking"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"X-XSS-Protection"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1; mode=block"})}),(0,r.jsx)(n.td,{children:"XSS filter"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Strict-Transport-Security"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"max-age=31536000; includeSubDomains"})}),(0,r.jsx)(n.td,{children:"Force HTTPS"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Referrer-Policy"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"strict-origin-when-cross-origin"})}),(0,r.jsx)(n.td,{children:"Limit referrer leakage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Content-Security-Policy"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"default-src 'self'"})}),(0,r.jsx)(n.td,{children:"Limit resource loading"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"audit-logging",children:"Audit Logging"}),"\n",(0,r.jsx)(n.h3,{id:"events-logged",children:"Events Logged"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Action"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.login"})}),(0,r.jsx)(n.td,{children:"Successful login"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.login.failed"})}),(0,r.jsx)(n.td,{children:"Failed login attempt"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.logout"})}),(0,r.jsx)(n.td,{children:"User logout"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.register"})}),(0,r.jsx)(n.td,{children:"New user registration"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.password.change"})}),(0,r.jsx)(n.td,{children:"Password changed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.password.reset"})}),(0,r.jsx)(n.td,{children:"Password reset completed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.2fa.enable"})}),(0,r.jsx)(n.td,{children:"2FA enabled"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"user.2fa.disable"})}),(0,r.jsx)(n.td,{children:"2FA disabled"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"org.create"})}),(0,r.jsx)(n.td,{children:"Organization created"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"org.update"})}),(0,r.jsx)(n.td,{children:"Organization updated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"member.invite"})}),(0,r.jsx)(n.td,{children:"Member invited"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"member.join"})}),(0,r.jsx)(n.td,{children:"Member accepted invite"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"member.remove"})}),(0,r.jsx)(n.td,{children:"Member removed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"member.role.change"})}),(0,r.jsx)(n.td,{children:"Member role changed"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"log-retention",children:"Log Retention"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Default: 90 days"}),"\n",(0,r.jsx)(n.li,{children:"Configurable via environment variable"}),"\n",(0,r.jsx)(n.li,{children:"Automatic cleanup via background worker"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>d,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);